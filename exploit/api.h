#pragma once

#include <Windows.h>

#ifdef __cplusplus
extern "C" {
#endif

// Returns loader version (e.g., 1)
__declspec(dllexport) DWORD GetLoaderVersion(void);

// Returns the address of CI options structure as an integer pointer.
// Returns 0 on failure.
__declspec(dllexport) intptr_t GetCiOptionsAddress(void);

// Checks if Driver Signature Enforcement (DSE) is currently enabled.
// Returns TRUE or FALSE.
__declspec(dllexport) BOOL IsDSEEnabled(void);

// Returns TRUE if the CI state has been patched (i.e., disabled previously)
__declspec(dllexport) BOOL IsDSEPatched(void);

// Attempts to re-enable DSE by restoring the original value.
// Returns TRUE on success.
__declspec(dllexport) BOOL DSEEnable(void);

// Attempts to disable DSE using the exploit chain.
// Returns TRUE on success.
__declspec(dllexport) BOOL DSEDisable(void);

__declspec(dllexport) BOOL ReadCIOptions(_Out_opt_ PULONG ciOptionsValue);

#ifdef __cplusplus
}
#endif
